<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book Management System</title>
    <!-- Using Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      /* Loading Spinner */
      .loader {
        border: 3px solid #f3f3f3;
        border-top: 3px solid #3498db;
        border-radius: 50%;
        width: 20px;
        height: 20px;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Error Input Style */
      .input-error {
        border-color: #ef4444 !important; /* Red-500 */
        background-color: #fef2f2;
      }
      .input-error:focus {
        outline-color: #ef4444 !important;
        outline-width: 2px;
      }
    </style>
  </head>
  <body class="bg-gray-50 font-sans text-gray-900">
    <!-- Notification Popup -->
    <div id="notification"
      class="fixed top-6 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg shadow-xl text-white font-semibold transition-all duration-300 opacity-0 pointer-events-none -translate-y-full z-50">
      Message goes here</div>

    <!-- Navigation -->
    <nav class="bg-blue-600 text-white p-4 shadow-md sticky top-0 z-40">
      <div class="container mx-auto flex justify-between items-center">
        <span class="text-xl font-bold tracking-wide">ðŸ“š BMS</span>
        <button onclick="fetchExternalData()"class="text-sm bg-blue-500 hover:bg-blue-400 px-3 py-1 rounded transition flex items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg"width="16"height="16"fill="currentColor"viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
            <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
          </svg>
          Load Real Data
        </button>
      </div>
    </nav>

    <!-- Main Container -->
    <main class="container mx-auto p-6 max-w-4xl">
      <!-- Form Section -->
      <div class="bg-white p-6 rounded-lg shadow-md mb-8">
        <div class="flex justify-between items-center mb-4">
          <h2 id="form-title" class="text-2xl font-semibold text-gray-700">
            Add New Book
          </h2>

         <!-- Async loader -->
          <div id="loading-indicator"class="hidden flex items-center text-sm text-blue-600 font-medium">
            <div class="loader mr-2"></div>
            Saving...
          </div>
        </div>

        <form id="BookForm"class="grid grid-cols-1 md:grid-cols-2 gap-6"novalidate>

          <!-- Title -->
          <div class="form-group col-span-2 md:col-span-1">
            <label for="title" class="block text-sm font-medium text-gray-700 mb-1">Book Title</label>
            <input type="text"id="title"class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none transition-colors"placeholder="Enter title"required/>
            <span class="text-xs text-red-500 hidden" id="error-title">Title is required</span>
          </div>

          <!-- Author -->
          <div class="form-group col-span-2 md:col-span-1">
            <label for="author" class="block text-sm font-medium text-gray-700 mb-1">Book Author</label>
            <input type="text"id="author"class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none transition-colors" placeholder="Enter author"required/>
            <span class="text-xs text-red-500 hidden" id="error-author">Author is required</span>
          </div>

          <!-- ISBN -->
          <div class="form-group">
            <label for="isbn"class="block text-sm font-medium text-gray-700 mb-1">ISBN (10-13 digits/dashes)</label>
            <input type="text"id="isbn"class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none transition-colors"placeholder="e.g. 978-3-16-148410-0"required/>
            <span class="text-xs text-red-500 hidden" id="error-isbn">Invalid ISBN format</span>
          </div>

          <!-- Publication Date -->
          <div class="form-group">
            <label for="publication_date"class="block text-sm font-medium text-gray-700 mb-1">Publication Date</label>
            <input type="date"id="publication_date"class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none transition-colors"required/>
            <span class="text-xs text-red-500 hidden" id="error-date">Date cannot be in the future</span>
          </div>

          <!-- Genre -->
          <div class="form-group col-span-2">
            <label for="genre"class="block text-sm font-medium text-gray-700 mb-1">Genre</label>
            <select id="genre"class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none transition-colors"required>
              <option value="" disabled selected>Select a genre...</option>
              <option value="Fiction">Fiction</option>
              <option value="Non-Fiction">Non-Fiction</option>
              <option value="Science-Fiction">Science-Fiction</option>
              <option value="Mystery">Mystery</option>
              <option value="Biography">Biography</option>
              <option value="History">History</option>
              <option value="Technology">Technology</option>
            </select>
          </div>

          <!-- Buttons -->
          <div class="col-span-2 flex gap-4">
            <button type="submit"id="submit-btn"class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition duration-200 disabled:opacity-50 disabled:cursor-not-allowed">
              Add Book</button>
            <button type="button"id="cancel-btn"onclick="cancelEdit()"class="hidden bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded transition duration-200">
              Cancel</button>
          </div>
        </form>
      </div>

      <!-- Dashboard Stats -->
      <div id="dashboard" class="mb-8 grid grid-cols-1 md:grid-cols-3 gap-4">
        <div
          class="bg-white p-4 rounded-lg shadow-md border-l-4 border-blue-500">
          <h3 class="text-xs font-bold text-gray-500 uppercase tracking-wide">
            Total Books
          </h3>
          <p id="total-count" class="text-2xl font-bold text-gray-800">0</p>
        </div>
        <div
          class="bg-white p-4 rounded-lg shadow-md border-l-4 border-purple-500 col-span-2">
          <h3
            class="text-xs font-bold text-gray-500 uppercase tracking-wide mb-2">
            Category Breakdown
          </h3>
          <div id="genre-stats" class="flex flex-wrap gap-2">
            <span class="text-sm text-gray-400 italic">No data available</span>
          </div>
        </div>
      </div>

      <!-- List Section -->
      <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div
          class="p-4 border-b bg-gray-50 flex flex-col md:flex-row justify-between items-center gap-4">
          <h2 class="text-xl font-semibold text-gray-700">
            Library Collection
          </h2>

          <!-- Async Search Input -->
          <div class="relative w-full md:w-64">
            <input type="text" id="search-input"placeholder="Server search (Type book name)..."class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"/>
            <div class="absolute left-3 top-2.5 text-gray-400">
              <svg xmlns="http://www.w3.org/2000/svg"width="16"height="16" fill="currentColor"viewBox="0 0 16 16">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
              </svg>
            </div>
          </div>
        </div>

        <div class="overflow-x-auto relative min-h-[200px]">
          <!-- Search Loading Overlay -->
          <div id="search-loader"class="hidden absolute inset-0 bg-white/80 z-10 flex flex-col justify-center items-center">
            <div class="loader mb-2"></div>
            <span class="text-xs text-gray-500">Searching server...</span>
          </div>

          <table class="w-full text-left border-collapse">
            <thead class="bg-gray-100 text-gray-800 font-semibold text-sm">
              <tr>
                <th class="p-4 border-b border-gray-200">Title</th>
                <th class="p-4 border-b border-gray-200">Author</th>
                <th class="p-4 border-b border-gray-200">ISBN</th>
                <th class="p-4 border-b border-gray-200">Date</th>
                <th class="p-4 border-b border-gray-200">Age</th>
                <th class="p-4 border-b border-gray-200">Genre</th>
                <th class="p-4 border-b border-gray-200 text-center">Actions</th>
              </tr>
            </thead>
            <tbody id="BookList" class="text-sm text-gray-700">
              <!-- Rows -->
            </tbody>
          </table>
          <div id="empty-message" class="hidden p-8 text-center text-gray-500">
            No books found.
          </div>
        </div>
      </div>
    </main>

    <script src="javascript.js"></script>
  </body>
</html>
